---
title: 关于建立app应用后台的一些思路
date: 2017-12-06 11:28:32
tags: 想法
categories: 随笔
---

> 像之前的[日志统计平台](http://pipeapple.xyz/2017/09/14/%E6%9C%80%E8%BF%91%E6%90%AD%E5%BB%BA%E7%BB%9F%E8%AE%A1%E5%B9%B3%E5%8F%B0%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%8F%E6%80%9D%E8%B7%AF%E5%92%8C%E5%AE%9E%E9%99%85%E6%93%8D%E4%BD%9C/#more), 但应用后台涉及面更广一些，api接口要求要更加严格。目前并没有太好的思路，边想边写吧。自己经验尚浅，以下之言尽做参考。  

<!--more-->


## 关于协同开发的一些想法  
1. 首先确认接口文档很重要，一开始由于自己有些别的事情，app开发和自己这边进度不一致，自己按照自己的想法写接口(之前口头说了一下)。后面陆续交流发现有些需求已经是又了变动，这就是很尴尬的一个情况了。


## 基础搭建的想法 
- 首先这次是一个比较完善的app后台，包括于登陆注册，用户界面等等都需要后端的支持，api需求较高，所以这次准备尝试djangorestframework，试试restful。
- 数据存储方面自己打算用MySQL，初步想法是条件允许的话设置主从，进行读写分离。
- redis作为消息队列，感觉没啥问题。
- Supervisor用来启动redis之类，防止意外挂掉。
- Sentry主要是用来收集错误日志，方便排查。

## 一些设计思路
- 无状态 
    根据[wiki](https://zh.wikipedia.org/wiki/%E6%97%A0%E7%8A%B6%E6%80%81%E5%8D%8F%E8%AE%AE)描述，即把每个请求作为与之前任何请求都无关的独立的事务，这个没啥问题。  
- 负载均衡
    目前先依赖于Nginx实现。 
- 异步化 
    目前主要是将部分耗时的操作可以放到celery中进行处理。
- 分布式
    目前只能是单应用了，考虑这块主要是怕服务器宕机之类，造成服务不可用。

## 模块
### API
业务服务的入口，在此可以按功能划分为多个api。如用户信息，登陆注册，邀请模块。该模块不去实现具体的业务逻辑，而是调用各个具体的业务服务。  

### 业务服务
该模块处理的是整个业务流程了，比如用户登录时进行验证，并将相应的处理信息返回给用户。

### 基础服务
各种第三方的服务啦，比如微信登陆，短信验证等等。


